<div class="content-container">
  <div class="values-container">
    <div class="values-instructions">
      Enter a drug name or structure, one per line, or separated by ',' or ';', and click the 'Resolve' button
    </div>
    <textarea class="targetBox" placeholder="aspirin" spellcheck="false" [formControl]="resolverCtrl"></textarea>
    <div class="values-actions-container">
      <span class="space-between"></span>
      <button mat-raised-button color="accent" (click)="nextFromValues()">Next</button>
    </div>
  </div>
  <div class="options-container">
    <div *ngIf="optionsManager">
      <div class="options-instructions">
        <span>Resolve to:</span>
        <mat-form-field floatLabel="never">
          <input matInput (keyup)="optionsManager.searchOptions($event.target.value)" placeholder="Search options">
        </mat-form-field>
      </div>
      <div class="options">
        <div class="filtered-options" *ngIf="optionsManager.searchResults && optionsManager.searchResults.length">
          <div class="filtered-options-header">
            Search results
          </div>
          <div class="filtered-options-body">
            <div *ngFor="let option of optionsManager.searchResults">
              <mat-checkbox (change)="option.setSelected($event.checked)" name={{option.name}}>
                {{option.title}}
              </mat-checkbox>
              <mat-icon matTooltip={{option.description}} class="help-icon">_help_</mat-icon>
            </div>
          </div>
        </div>
        <mat-accordion multi="true">
          <mat-expansion-panel *ngFor="let categoryName of optionsManager.categoryNames" [expanded]="categoryName == 'Active Options'">
            <mat-expansion-panel-header>
              <mat-panel-title>
                {{categoryName}}
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div>
              <div *ngFor="let option of optionsManager.categories[categoryName]">
                <mat-checkbox [checked]="lastUsedOptions[option.name]" (change)="option.setSelected($event.checked)" name={{option.name}}>
                  {{option.title}}
                </mat-checkbox>
                <mat-icon matTooltip={{option.description}} class="help-icon">_help_</mat-icon>
              </div>
            </div>
          </mat-expansion-panel>
        </mat-accordion>

        <!-- <div *ngFor="let option of options">
        <mat-checkbox (change)="checked($event, option.name)" name={{option.name}}>
          {{option.title}}
        </mat-checkbox>
        <mat-icon matTooltip={{option.description}} class="help-icon">_help_</mat-icon>
      </div> -->
      </div>
    </div>
    <div class="actions-container">
      <button class="show-on-small" mat-raised-button color="accent" (click)="backFromOptions()">Back</button>
      <span class="space-between"></span>
      <button class="resolve-button" mat-raised-button color="accent" name="Calbutton" (click)="resolve()" [disabled]="allowResolve() || isLoading">{{resolveButtonLabel}}</button>
    </div>
  </div>
  <div class="results-container">
    <div class="results-instructions-container">
      <div #dataList *ngIf="dataSource.data.length > 0" class="results-instructions">
        <span class="results-expand-shrink">
          <a *ngIf="!isResultsExpanded" (click)="expandResults()" class="" matTooltip="Full screen">
            <i class="material-icons">
              fullscreen
            </i>
          </a>
          <a *ngIf="isResultsExpanded" (click)="shrinkResults()" class="">
            <i class="material-icons">
              fullscreen_exit
            </i>
          </a>
        </span>
        <span class="space-between"></span>
        <div>
          <button mat-button [matMenuTriggerFor]="menu">
            Download Data
            <mat-icon>file_download</mat-icon>
          </button>
        </div>
        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)=" downloadJSON()">
            <mat-icon>code</mat-icon>
            <span>JSON</span>
          </button>
          <button mat-menu-item (click)=" downloadCSV()">
            <mat-icon>border_all</mat-icon>
            <span>CSV</span>
          </button>
        </mat-menu>
        <div>
          <mat-slide-toggle [color]="'primary'" (change)="showTable($event)">
            Show data in table
          </mat-slide-toggle>
        </div>
      </div>
    </div>
    <div *ngIf="loaded && showTableData === true" class="results-sub-container">
      <div fxLayout="row" #dataList>
        <span class="space-between"></span>
        <mat-form-field class="filter-input">
          <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
        </mat-form-field>
      </div>
      <div class="results-table-container">
        <div class="results-table-sub-container">
          <table mat-table #table [dataSource]="dataSource" matSort>
            <!--- Note that these columns can be defined in any order.
                  The actual rendered columns are set as a property on the row definition" -->
            <ng-container *ngFor="let field of fields" matColumnDef="{{field}}">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>{{getLabel(field)}}</th>
              <td mat-cell *matCellDef="let row">
                {{replacePipes(row[field])}}
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="fields"></tr>
            <tr mat-row *matRowDef="let row; columns: fields;"></tr>
          </table>
        </div>
      </div>
    </div>
    <div class="textarea-results-container" *ngIf="loaded && showTableData === false">
      <textarea>{{rawData}}</textarea>
    </div>
    <div class="results-actions-container">
      <button mat-raised-button color="accent" (click)="backFromResults()">Back</button>
    </div>
  </div>
</div>

<!-- <br> -->
<!-- <div fxLayout="row" fxLayoutAlign="center center" fxLayout.xs="column">
  <div fxFlex="95">
    <div class="options-grid">
      <div *ngFor="let option of options">
        <mat-checkbox (change)="checked($event, option.name)" name={{option.name}}>
          {{option.title}}
        </mat-checkbox>
        <mat-icon matTooltip={{option.description}} class="help-icon">_help_</mat-icon>
      </div>
    </div>
  </div>
</div> -->
<!-- <br> -->
<!-- <div #dataList *ngIf="dataSource.data.length > 0" fxLayout="row" fxLayout.xs="column" fxLayoutAlign="end center">
  <div fxFlex="10">
    <button mat-button [matMenuTriggerFor]="menu">
      Download Data <mat-icon>file_download</mat-icon>
    </button>
  </div>
  <mat-menu #menu="matMenu">
    <button mat-menu-item (click)=" downloadJSON()">
      <mat-icon>code</mat-icon>
      <span>JSON</span>
    </button>
    <button mat-menu-item (click)=" downloadCSV()">
      <mat-icon>border_all</mat-icon>
      <span>CSV</span>
    </button>
  </mat-menu>
  <div fxFlex="20">
    <mat-slide-toggle [color]="'primary'" (change)="showTable($event)">
      Show data in table
    </mat-slide-toggle>
  </div>
</div> -->

<!-- <div *ngIf="loaded && showTableData === true" fxLayout="row" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutAlign="space-around start"
  class="body-row">
  <div fxFlex="95">
    <div #dataList fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-around center">
      <div fxFlex="50">
        <mat-form-field>
          <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
        </mat-form-field>
      </div>
    </div>
    <div fxFlex="95">
      <mat-table #table [dataSource]="dataSource" matSort> -->
<!--- Note that these columns can be defined in any order.
            The actual rendered columns are set as a property on the row definition" -->
<!-- <ng-container *ngFor="let field of fields" matColumnDef="{{field}}">
          <mat-header-cell *matHeaderCellDef mat-sort-header>{{getLabel(field)}}</mat-header-cell>
          <mat-cell *matCellDef="let row">
            {{row[field]}}
          </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="fields"></mat-header-row>
        <mat-row *matRowDef="let row; columns: fields;" fxLayoutAlign="center start"></mat-row>
      </mat-table>
    </div>
  </div>
</div>

<div *ngIf="loaded && showTableData === false" fxLayout="row" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutAlign="space-around start">
  <div fxFlex="95">
    <textarea class="raw">{{rawData}}</textarea>
  </div>
</div> -->
<!-- <br>
<br>
<br> -->
<!--
    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
-->